# Workspace-level Cargo configuration
#
# This config doesn't set a default target, so:
# - `cargo build -p dashboard-simulator` builds for host (Windows/Linux/macOS)
# - `cargo build -p dashboard-pico --target thumbv8m.main-none-eabihf` builds for Pico 2
#
# TIP: Use the aliases below for convenience:
#   cargo pico        # build pico
#   cargo sim         # run simulator

[env]
DEFMT_LOG = "debug"

# ARM Cortex-M33 target settings (Pico 2 / RP2350)
[target.thumbv8m.main-none-eabihf]
rustflags = [
    "-C", "link-arg=--nmagic",
    "-C", "link-arg=-Tlink.x",
    "-C", "link-arg=-Tdefmt.x",
    "-C", "target-cpu=cortex-m33",
]
runner = "tools/picotool.exe load -u -v -x -t elf"

# Convenient aliases
[alias]
pico = "build -p dashboard-pico --target thumbv8m.main-none-eabihf --release"
pico-run = "run -p dashboard-pico --target thumbv8m.main-none-eabihf --release"
pico-fast = "build -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-common/simple-outline"
pico-fast-run = "run -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-common/simple-outline"
pico-oc = "build -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-pico/overclock"
pico-oc-run = "run -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-pico/overclock"
pico-fast-oc = "build -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-common/simple-outline,dashboard-pico/overclock"
pico-fast-oc-run = "run -p dashboard-pico --target thumbv8m.main-none-eabihf --release --features dashboard-common/simple-outline,dashboard-pico/overclock"
sim = "run -p dashboard-simulator --release"
sim-fast = "run -p dashboard-simulator --release --features dashboard-common/simple-outline"
