# Workspace-level Cargo configuration
#
# TIP: Use the aliases below for convenience:
#   cargo pico2           # build pico2
#   cargo pico2-fast-oc   # build with overclock + fast outlines

[env]
DEFMT_LOG = "debug"

# Default target for all builds (Pico 2 / RP2350)
[build]
target = "thumbv8m.main-none-eabihf"

# ARM Cortex-M33 target settings (Pico 2 / RP2350)
[target.thumbv8m.main-none-eabihf]
rustflags = [
    "-C", "link-arg=--nmagic",
    "-C", "link-arg=-Tlink.x",
    "-C", "link-arg=-Tdefmt.x",
    "-C", "target-cpu=cortex-m33",
]
runner = "tools/picotool.exe load -u -v -x -t elf"

# Convenient aliases (target inherited from [build])
[alias]
pico2 = "build -p dashboard-pico2 --release"
pico2-run = "run -p dashboard-pico2 --release"
pico2-fast = "build -p dashboard-pico2 --release --features simple-outline"
pico2-fast-run = "run -p dashboard-pico2 --release --features simple-outline"
# Overclock: 250 MHz @ 1.10V (optimal SPI timing)
pico2-oc = "build -p dashboard-pico2 --release --features overclock"
pico2-oc-run = "run -p dashboard-pico2 --release --features overclock"
pico2-fast-oc = "build -p dashboard-pico2 --release --features simple-outline,overclock"
pico2-fast-oc-run = "run -p dashboard-pico2 --release --features simple-outline,overclock"
# SPI 70 MHz: 280 MHz @ 1.30V (280/4 = 70 MHz SPI, beyond ST7789 datasheet)
pico2-spi70 = "build -p dashboard-pico2 --release --features simple-outline,spi-70mhz"
pico2-spi70-run = "run -p dashboard-pico2 --release --features simple-outline,spi-70mhz"
