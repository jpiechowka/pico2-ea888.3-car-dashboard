# Workspace-level Cargo configuration
#
# TIP: Use the aliases below for convenience:
#   cargo pico2           # build pico2
#   cargo pico2-fast-oc   # build with overclock + fast outlines

[env]
DEFMT_LOG = "debug"

# Default target for all builds (Pico 2 / RP2350)
[build]
target = "thumbv8m.main-none-eabihf"

# ARM Cortex-M33 target settings (Pico 2 / RP2350)
[target.thumbv8m.main-none-eabihf]
rustflags = [
    "-C", "link-arg=--nmagic",
    "-C", "link-arg=-Tlink.x",
    "-C", "link-arg=-Tdefmt.x",
    "-C", "target-cpu=cortex-m33",
]
runner = "tools/picotool.exe load -u -v -x -t elf"

# Convenient aliases (target inherited from [build])
[alias]
pico2 = "build -p dashboard-pico2 --release"
pico2-run = "run -p dashboard-pico2 --release"
pico2-fast = "build -p dashboard-pico2 --release --features simple-outline"
pico2-fast-run = "run -p dashboard-pico2 --release --features simple-outline"

# Overclock profiles: cpu{MHz}-spi{MHz}-{voltage}
# All use simple-outline for best FPS

# 250 MHz @ 1.10V (62.5 MHz SPI - ST7789 datasheet max)
pico2-250-62-1v10 = "build -p dashboard-pico2 --release --features simple-outline,cpu250-spi62-1v10"
pico2-250-62-1v10-run = "run -p dashboard-pico2 --release --features simple-outline,cpu250-spi62-1v10"

# 280 MHz @ 1.30V (70 MHz SPI - beyond ST7789 datasheet)
pico2-280-70-1v30 = "build -p dashboard-pico2 --release --features simple-outline,cpu280-spi70-1v30"
pico2-280-70-1v30-run = "run -p dashboard-pico2 --release --features simple-outline,cpu280-spi70-1v30"

# 300 MHz @ 1.30V (75 MHz SPI)
pico2-300-75-1v30 = "build -p dashboard-pico2 --release --features simple-outline,cpu300-spi75-1v30"
pico2-300-75-1v30-run = "run -p dashboard-pico2 --release --features simple-outline,cpu300-spi75-1v30"

# 320 MHz @ 1.40V (80 MHz SPI - extreme overclock)
pico2-320-80-1v40 = "build -p dashboard-pico2 --release --features simple-outline,cpu320-spi80-1v40"
pico2-320-80-1v40-run = "run -p dashboard-pico2 --release --features simple-outline,cpu320-spi80-1v40"

# 340 MHz @ 1.40V (85 MHz SPI - extreme overclock)
pico2-340-85-1v40 = "build -p dashboard-pico2 --release --features simple-outline,cpu340-spi85-1v40"
pico2-340-85-1v40-run = "run -p dashboard-pico2 --release --features simple-outline,cpu340-spi85-1v40"
